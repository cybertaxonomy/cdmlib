r3970 trunk/cdmlib