<project name="Java application deb packager" default="deb_package">

	<echo>basedir: ${basedir}</echo>
	<!-- UNUSED
  <tstamp>
    <format property="project.buildtimestamp" pattern="yyyyMMddkkmmss"/>
  </tstamp>
  -->
	
	<!-- Package Name & Version -->
	<property name="package.name" value="cdmserver" />
	<!-- ${project.fullversionstring} must be passed as parameter --> 
	<property name="version.cdmserver" value="${project.fullversionstring}" />
	<property name="version.debian" value="5" />
	<echo>upstream-version = version.cdmserver: ${version.cdmserver}</echo>
	<echo>debian-version = version.debian: ${version.debian}</echo>
	
	<!-- Various Filenames -->
	<property name="cdmserverscript.filename" value="cdmserver" />
	<property name="datasources.filename" value="datasources.xml" />
	<property name="cdmserver.filename" value="cdm-server-2.4.jar" />
  <property name="cdmserver.destinationfilename" value="cdm-server.jar" />

	<!-- Various Paths -->
	<property name="installer.path" value="src/main/installer" />
	<property name="cdmserver.target.path" value="target" />
	<property name="dest.path" value="usr/bin" />
	<property name="linux.installer.path" value="${installer.path}/linux" />
	<!-- location -->
	<property name="basedirToRemoteRoot" value="../../../.." />
	<!--
    <property name="initscript.path" location="${installer.path}/linux/initscript" />
	<property name="cdmlibremote.path" value="../../../.." />
	-->
	<property name="cdmserverscript.path" value="${installer.path}/templates" />
	<!-- location -->
	<property name="cdmserver.path" value="${installer.path}/templates" />
	<!-- location -->
	<property name="datasources.path" value="${installer.path}/templates/.cdmLibrary" />
	<!-- location -->
	<property name="postinst.path" value="${linux.installer.path}"/>
	<!-- location -->
	<property name="postrm.path" value="${linux.installer.path}"/>
	<!-- location -->
	<property name="ant-deb-task.path" value="${linux.installer.path}/../lib"/>
	<!-- location -->

	<!-- create distribution target -->
	<path id="ant-deb-task.classpath">
		<fileset dir="${basedir}/${ant-deb-task.path}" includes="*.jar" />
	</path>	
  <taskdef resource="ant_deb_task.properties" classpathref="ant-deb-task.classpath">
	</taskdef>

	<target name="deb_package" description="build the deb file">
		<mkdir dir="dist" />
		<deb todir="dist" package="${package.name}" 
			section="graphics" postinst="${postinst.path}/postinst" 
			postrm="${postinst.path}/postrm">
			<version upstream="${version.cdmserver}" debian="${version.debian}" />
			<maintainer name="BGBM Team" email="editsupport@bgbm.de" />
			<description synopsis="CDM Server: The CDM model for the EDIT Biodiversity Project">
CDM Server is a cross platform blablabla, visit www.bgbm.de for more info.
            </description>

			<tarfileset file="${linux.installer.path}/${cdmserverscript.filename}" prefix="${dest.path}" />
			<tarfileset file="${datasources.path}/${datasources.filename}" prefix="${dest.path}" />
			<tarfileset file="${cdmserver.target.path}/${cdmserver.filename}" fullpath="${dest.path}/${cdmserver.destinationfilename}" />

		</deb>
	</target>
	<!--
	 <target name="clean" description="remove all work folders">
	 	  <delete dir="dist"/>
	 </target>
	 -->
</project>